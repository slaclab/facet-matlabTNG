sigm=[ 0.207608947052626E-07 -0.358805225003625E-08  0.188994869419206E-08 -0.356578805894645E-10
      -0.358805225003625E-08  0.764725490081904E-09 -0.140978531590826E-09 -0.321355499854593E-11
       0.188994869419206E-08 -0.140978531590826E-09  0.691984845950062E-09 -0.536925665775580E-10
      -0.356578805894645E-10 -0.321355499854593E-11 -0.536925665775580E-10  0.660205889063416E-11];
sig=[sqrt(sigm(1,1)) sqrt(sigm(2,2)) sqrt(sigm(3,3)) sqrt(sigm(4,4))];
r=zeros(4,4);
for i=1:4
   for j=1:i-1
      r(i,j)=sigm(i,j)/(sig(i)*sig(j));
   end
end
ex=sqrt(det(sigm(1:2,1:2)));
ey=sqrt(det(sigm(3:4,3:4)));
J=[ 0  1  0  0
   -1  0  0  0
    0  0  0  1
    0  0 -1  0];
t2=trace((sigm*J)^2);
t4=trace((sigm*J)^4);
e1=sqrt((-t2+sqrt(-t2^2+4*t4))/4);
e2=sqrt((-t2-sqrt(-t2^2+4*t4))/4);

% back-transport to beginning of EXT

R=[ 2.20562   6.73711   0.00000   0.00000
   -0.49685  -1.06426   0.00000   0.00000
    0.00000   0.00000   2.96260  -5.35795
    0.00000   0.00000   0.10445   0.14864];
sigm0=inv(R)*sigm*inv(R');
sig0=[sqrt(sigm0(1,1)) sqrt(sigm0(2,2)) sqrt(sigm0(3,3)) sqrt(sigm0(4,4))];
r0=zeros(4,4);
for i=1:4
   for j=1:i-1
      r0(i,j)=sigm0(i,j)/(sig0(i)*sig0(j));
   end
end
